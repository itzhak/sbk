<?php

// !!! I haven;t looked at http://drupal.org/node/521630 but it might
// be helpful if this doesn't work well.

// Generated by taxonomy_export 0.1,
// then hacked up, don't want yet another dependency on taxonomy_export
function _verdant_ride_taxonomy() {	
	$vocabulary = array(
		//'vid' => '1',
		'name' => t('Means of Transit'),
		'description' => '',
		'help' => '',
		'relations' => '1',
		'hierarchy' => '1',
		'multiple' => '0',  /* reasons for both 0 or 1 as options */
		'required' => '1',
		'tags' => '0',
		'module' => 'verdant_share', //!!! was 'taxonomy' in the export
		'weight' => '0',
		'nodes' =>  array (			
			'share_ride' => 'share_ride',
   	    ),
	);
 
	// If we failed to uninstall, then we're done, no action
	$vocabs = taxonomy_get_vocabularies(NULL);
	foreach ($vocabs as $vocab_object) {
		if ($vocab_object->name == $vocabulary['name']) {
			$vocabulary['vid'] = $vocab_object->vid;
			drupal_set_message(t("Rideshare vocabulary appears to have been set already, not rebuilt."));
			return;			
		}
	}

	$status = taxonomy_save_vocabulary($vocabulary);

	// We need the vid.  http://drupal.org/node/460328 ?
	// After all that, did tsv change it?
	$vocabs = taxonomy_get_vocabularies(NULL);
	foreach ($vocabs as $vocab_object) {
		if ($vocab_object->name == $vocabulary['name']) {
			$vid = $vocab_object->vid;
			//fubar early versions want last vid that matches-- break;
		}
	}
  
	$values = array('@status' => $status, '@vid' => $vid);

	drupal_set_message(t("Tried to save vocabulary.  Status is VID is ", $values));

	$terms = array (
		0 => array(
			'vid' => $vid,
			'name' => t('Take the group bus or group taxi'),
			'description' => t('Let\'s travel together'),
			'weight' => '0',
			'depth' => 0,
			'parents' => array ( 0 => '0',),
		),
		1 =>  array(
			'vid' => $vid,
			'name' => t('Driver'),
			'description' => '',
			'weight' => '1',
			'depth' => 0,
			'parents' => array ( 0 => '0',),
		),
		2 =>  array(
			'vid' => $vid,
			'name' => t('Driver or Passenger'),
			'description' => '',
			'weight' => '2',
			'depth' => 0,
			'parents' => array ( 0 => '0',),
		),
		3 => array(
			'vid' => $vid,
			'name' => t('Passenger only'),
			'description' => '',
			'weight' => '3',
			'depth' => 0,
			'parents' => array ( 0 => '0',),
    	),
	);

	foreach ($terms as $term) {
		taxonomy_save_term($term);
	}
	
	//set taxanomy for event icons
	$vocabulary = array(
		//'vid' => '1',
		'name' => t('Event Icons'),
		'description' => 'icon that will shown on event location',
		'help' => '',
		'relations' => '1',
		'hierarchy' => '1',
		'multiple' => '0',  /* reasons for both 0 or 1 as options */
		'required' => '1',
		'tags' => '0',
		'module' => 'verdant_share', //!!! was 'taxonomy' in the export
		'weight' => '0',
		'nodes' =>  array (			
			'event' => 'event',
   	    ),
	);
	
	// If we failed to uninstall, then we're done, no action
	$vocabs = taxonomy_get_vocabularies(NULL);
	foreach ($vocabs as $vocab_object) {
		if ($vocab_object->name == $vocabulary['name']) {
			$vocabulary['vid'] = $vocab_object->vid;
			drupal_set_message(t("Rideshare vocabulary appears to have been set already, not rebuilt."));
			return;			
		}
	}
	
	$status = taxonomy_save_vocabulary($vocabulary);

	// We need the vid.  http://drupal.org/node/460328 ?
	// After all that, did tsv change it?
	$vocabs = taxonomy_get_vocabularies(NULL);
	foreach ($vocabs as $vocab_object) {
		if ($vocab_object->name == $vocabulary['name']) {
			$vid = $vocab_object->vid;
			//fubar early versions want last vid that matches-- break;
		}
	}
  
	$values = array('@status' => $status, '@vid' => $vid);

	drupal_set_message(t("Tried to save vocabulary.  Status is VID is ", $values));

	$terms = array (
		0 => array(
			'vid' => $vid,
			'name' => t('event default pic'),
			'description' => t('Event default picture'),
			'weight' => '0',
			'depth' => 0,
			'parents' => array ( 0 => '0',),
		),
	);

	foreach ($terms as $term) {
		taxonomy_save_term($term);
	}
}


